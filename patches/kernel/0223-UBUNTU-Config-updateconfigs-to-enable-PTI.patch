From 22ad4e1d6ca8885ad2cca842838125de9130eb7a Mon Sep 17 00:00:00 2001
From: Andy Whitcroft <apw@canonical.com>
Date: Mon, 18 Dec 2017 12:09:25 +0000
Subject: [PATCH 223/232] UBUNTU: [Config] updateconfigs to enable PTI
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

CVE-2017-5754

Signed-off-by: Andy Whitcroft <apw@canonical.com>
Signed-off-by: Kleber Sacilotto de Souza <kleber.souza@canonical.com>
(cherry picked from commit 239497489e75fe18b55f568a43c76fd65a7cbf4f)
Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 debian.master/config/amd64/config.common.amd64 | 1 +
 debian.master/config/config.common.ubuntu      | 5 ++++-
 debian.master/config/i386/config.common.i386   | 1 +
 3 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/debian.master/config/amd64/config.common.amd64 b/debian.master/config/amd64/config.common.amd64
index 6df8bcf72690..6412a1366160 100644
--- a/debian.master/config/amd64/config.common.amd64
+++ b/debian.master/config/amd64/config.common.amd64
@@ -471,6 +471,7 @@ CONFIG_UIO_PRUSS=m
 CONFIG_UIO_SERCOS3=m
 CONFIG_ULTRIX_PARTITION=y
 CONFIG_UNIXWARE_DISKLABEL=y
+# CONFIG_UNWINDER_FRAME_POINTER is not set
 CONFIG_USB_DWC2_PCI=m
 CONFIG_USB_EHCI_HCD_PLATFORM=y
 CONFIG_USB_GADGET=m
diff --git a/debian.master/config/config.common.ubuntu b/debian.master/config/config.common.ubuntu
index 37a14874f7f9..ebb00db16844 100644
--- a/debian.master/config/config.common.ubuntu
+++ b/debian.master/config/config.common.ubuntu
@@ -6201,6 +6201,7 @@ CONFIG_PADATA=y
 CONFIG_PAGE_COUNTER=y
 # CONFIG_PAGE_OWNER is not set
 # CONFIG_PAGE_POISONING is not set
+CONFIG_PAGE_TABLE_ISOLATION=y
 CONFIG_PALMAS_GPADC=m
 CONFIG_PANASONIC_LAPTOP=m
 CONFIG_PANEL=m
@@ -8659,7 +8660,7 @@ CONFIG_STACKTRACE=y
 CONFIG_STACKTRACE_SUPPORT=y
 CONFIG_STACK_GUARD=256
 CONFIG_STACK_TRACER=y
-# CONFIG_STACK_VALIDATION is not set
+CONFIG_STACK_VALIDATION=y
 # CONFIG_STAGING_BOARD is not set
 CONFIG_STAGING_MEDIA=y
 # CONFIG_STATIC_KEYS_SELFTEST is not set
@@ -9173,6 +9174,8 @@ CONFIG_UNIX=y
 CONFIG_UNIX98_PTYS=y
 CONFIG_UNIX_DIAG=m
 CONFIG_UNUSED_SYMBOLS=y
+# CONFIG_UNWINDER_GUESS is not set
+CONFIG_UNWINDER_ORC=y
 CONFIG_UPROBES=y
 CONFIG_UPROBE_EVENTS=y
 CONFIG_US5182D=m
diff --git a/debian.master/config/i386/config.common.i386 b/debian.master/config/i386/config.common.i386
index eb973e0eb199..4b8d6a14e31c 100644
--- a/debian.master/config/i386/config.common.i386
+++ b/debian.master/config/i386/config.common.i386
@@ -463,6 +463,7 @@ CONFIG_UIO_PRUSS=m
 CONFIG_UIO_SERCOS3=m
 CONFIG_ULTRIX_PARTITION=y
 CONFIG_UNIXWARE_DISKLABEL=y
+CONFIG_UNWINDER_FRAME_POINTER=y
 CONFIG_USB_DWC2_PCI=m
 CONFIG_USB_EHCI_HCD_PLATFORM=y
 CONFIG_USB_GADGET=m
-- 
2.14.2

